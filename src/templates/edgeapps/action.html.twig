{% extends "base.html.twig" %}
{% block title %}
    Web Setup
{% endblock title %}
{% block content %}

    <div class="card">
        <div class="card-body p-3">
        {# <div class="container"> #}
            <div class="row my-5" style="margin-left: 15px;">
            <div class="col-md-6">
                {% if not framework_ready %}
                    <h1><i class="fas fa-tools"></i></h1>
                    <h2>Framework Not Ready</h2>
                    <p style="color: red;">The framework is currnetly not available. Please check the logs in the <a href="/settings">settings page</a> for detailed information.</p>
                    <p>
                        <a href="/edgeapps">
                            <button class="btn btn-icon btn-3 btn-secondary" type="button">
                                <span class="btn-inner--icon" style="margin-right: 10px;"><i class="ni ni-bold-left"></i></span>
                                <span class="btn-inner--text">Go back</span>
                            </button>
                        </a>
                    </p>

                {% else %}
                    {% if result == "executing" %} 
                        <h1><img src="/assets/img/spinner.gif"></h1>
                        <p><b>
                                {% if action == "remove" %}
                                    <h2>Removing {{edgeapp}} ... </h2><p>This can take a minute...</p>
                                {% endif %}
                                {% if action == "install" %}
                                    <h2>Installing {{edgeapp}} ... </h2><p>This can take a minute...</p>
                                {% endif %}
                                {% if action == "stop" %}
                                    <h2>Stopping {{edgeapp}} ... </h2><p>This can take a minute...</p>
                                {% endif %}
                                {% if action == "start" %}
                                    <h2>Starting {{edgeapp}} ... </h2><p>This can take a minute...</p>
                                {% endif %}
                                {% if action == "enable_online" %}
                                    <h2>Enabling online access to {{edgeapp}} ... </h2><p>This can take a minute...</p>
                                {% endif %}
                                {% if action == "disable_online" %}
                                    <h2>Disabling online access to {{edgeapp}} ... </h2><p>This can take a minute...</p>
                                {% endif %}
                            </b></p>

                        <script>

                            redirectTimeout = 60000

                            {% if action == "disable_online" or action == "enable_online" or action == "remove" or action == "install" %}
                            redirectTimeout = 90000
                            {% endif %}

                            window.setTimeout(function(){

                                // Move to the applications view...
                                window.location.href = "/edgeapps";

                            }, redirectTimeout); // This is a loooong time... It can be better! (sysctl)
                        </script>
                    {% endif %}

                    {% if result == "edgeapp_not_found" %}
                        <h2 style="color: red;">Error: EdgeApp Not Found</h2>
                        <a href="/edgeapps">
                            <button class="btn btn-icon btn-3 btn-secondary" type="button">
                                <span class="btn-inner--icon" style="margin-right: 10px;"><i class="ni ni-ungroup"></i></span>
                                <span class="btn-inner--text">Go Back</span>
                            </button></p>
                        </a>
                    {% endif %}

                    {% if result == "invalid_action" %}
                        <h2 style="color: red;">Error: Invalid Action</h2>
                        <a href="/edgeapps">
                            <button class="btn btn-icon btn-3 btn-secondary" type="button">
                                <span class="btn-inner--icon" style="margin-right: 10px;"><i class="ni ni-ungroup"></i></span>
                                <span class="btn-inner--text">Go Back</span>
                            </button></p>
                        </a>
                    {% endif %}

                    {% if result == "error" %}
                        <h1><i class="ni ni-support-16"></i></h1>
                        <h2>Unexpected Error</h2>
                        <p>A problem ocurred when performing this operation.</p>
                        <p>
                            <a href="/settings/logs" target="_blank">
                                <button class="btn btn-icon btn-3 btn-secondary" type="button">
                                    <span class="btn-inner--icon" style="margin-right: 10px;"><i class="ni ni-ungroup"></i></span>
                                    <span class="btn-inner--text">See Detailed Logs</span>
                                </button>
                            </a>
                        </p>
                        
                    {% endif %}

                {% endif %}
            </div>
            </div>
        {# <div> #}
        </div>
    </div>
{% endblock content %}
